# Rush Hour（高峰时刻）

## 作品概述

这是一个极简风格的物理仿真交互艺术作品，展现了"人"字形物体从漏斗顶部坠落，经过漏斗通道，最终落到带有空缺的地面上的场景。

## 技术实现

- **物理引擎**: Matter.js - 处理所有的物理仿真，包括刚体运动、碰撞检测和重力效果
- **SVG 路径转换**: 使用 Matter.js 的 `Svg.pathToVertices()` 将 SVG 路径转换为顶点数组，再通过 `Bodies.fromVertices()` 创建复杂的刚体形状（参考 [terrain.js 示例](https://github.com/liabru/matter-js/blob/master/examples/terrain.js)）
- **凹多边形处理**: 使用 `poly-decomp` 库自动将凹多边形分解为多个凸多边形，确保物理碰撞的准确性
- **SVGPathSeg Polyfill**: 使用 pathseg.js polyfill 解决现代浏览器中 SVGPathSeg API 被废弃的问题
- **渲染引擎**: p5.js - 通过 useP5 hook 实现极简风格的视觉呈现
- **视觉风格**: 白色背景，黑色线条，极简主义设计

## 主要特性

1. **漏斗地形**: 使用 SVG 路径通过 Matter.js 的 `Svg.pathToVertices` 和 `Bodies.fromVertices` 创建平滑的曲线刚体，呈现真实的漏斗形状
2. **分段地面**: 横向地面被分割成多个段落，段落之间有固定间隔的空缺
3. **动态球体**: 持续从漏斗顶部生成，大小在一定范围内随机变化
4. **文字渲染**: 每个球体被渲染为"人"字，随球体旋转而旋转，象征人群在时代洪流中的翻滚
5. **物理真实性**: 球体具有真实的物理属性（质量、摩擦力、弹性、旋转等）

## 艺术隐喻

作品通过物理仿真的方式，隐喻了现代生活中的"高峰时刻"：
- 漏斗象征着生活中的瓶颈和限制
- 坠落的"人"字象征着人群的流动和个体的无奈
- 分段的地面象征着社会结构的断裂和间隙
- 不断生成的新球体象征着永不停歇的时间流动

## 技术细节：凹多边形渲染

Matter.js 使用 `poly-decomp` 将凹多边形自动分解为多个凸多边形（parts）来处理物理碰撞。关键点：

1. **物理结构**：分解后的刚体是一个复合体，包含多个子刚体（`body.parts`）
2. **渲染要求**：必须遍历并渲染所有的 `parts`，而不是只渲染主体的顶点
3. **顶点坐标**：每个 part 的顶点已经是世界坐标，可以直接使用
4. **为什么之前显示错误**：
   - 碰撞检测正常 → 物理引擎正确分解了形状
   - 渲染错误 → 只绘制了主体顶点，没有绘制分解后的各个部分

## 参数配置

可以通过修改代码中的常量来调整作品效果：

- `FUNNEL_PATH`: SVG 路径字符串，定义漏斗的形状
- `FUNNEL_WIDTH`: 漏斗参考宽度
- `FUNNEL_HEIGHT`: 漏斗参考高度
- `GROUND_SEGMENT_WIDTH`: 地面每段的宽度
- `GROUND_GAP_WIDTH`: 地面空缺的宽度
- `BALL_MIN_RADIUS` / `BALL_MAX_RADIUS`: 球体半径范围
- `BALL_SPAWN_INTERVAL`: 球体生成间隔（毫秒）

## Debug 模式

在 URL 中添加 `?debug` 参数可以启用调试模式，例如：`/work/rush-hour?debug`

Debug 模式下会显示：
- **球体调试信息**：
  - 球体的边框（半透明蓝色圆圈）
  - 方向向量（从球体中心指向球体旋转方向的红色半径线，显示球体的姿态）
  - 角度数值（显示球体的旋转角度，单位：度）
  - 角速度数值（显示球体的旋转速度）
- **漏斗分解可视化**：
  - 用不同颜色填充显示漏斗被分解成的各个凸多边形部分
  - 帮助理解 poly-decomp 如何将凹多边形分解为多个凸多边形

这对于理解物理仿真中球体的旋转状态和凹多边形分解过程非常有用。

